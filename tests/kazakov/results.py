__author__ = 'mkompan'

from rggraphenv.symbolic_functions import var, tgamma, e ,cln

s,t = var('s t')
fact = lambda x: tgamma(x+1)

res_d8_kazakov = {'I1': 1/fact(3),
                  'J1': -s/fact(3)/fact(4),
                  'J2': -t/fact(3)/fact(4),
                  'K1': s*s/fact(5)/fact(4),
                  'K2': t*t/fact(5)/fact(4),
                  'K3': s*(3*s*s-2*s*t+t*t)/fact(5)/fact(4)/fact(3)/9,
                  'K4': t*(3*t*t-2*s*t+s*s)/fact(5)/fact(4)/fact(3)/9,
                  }
print res_d8_kazakov


#D8_s_s_s_1|23456|3|45|5|6||:0|0_0_1_0_0|0|0_0|0|0||:s|0|t|0|s|0|t/1|23456|3|45|5|6||:0|0_0_1_0_0|0|0_0|0|0||:s|0|t|0|s|0|t_0_V7_E-2.run.res.1M:result = 0.000347177061559275147
#D8_s_s_t_1|23456|3|45|5|6||:0|0_0_1_0_0|0|0_0|0|0||:s|0|t|0|s|0|t/1|23456|3|45|5|6||:0|0_0_1_0_0|0|0_0|0|0||:s|0|t|0|s|0|t_0_V7_E-2.run.res.1M:result = -7.71577109669606447e-05
#D8_1|234||||:0|0_0_0||||:s|0|s|t|t/1|234||||:0|0_0_0||||:s|0|s|t|t_0_V3_E0.run.res.1M:result = 0.166666380789930679
#D8_s_1|234|3|45|||:0|0_0_0|0|0_0|||:s|0|t|0|t|s/1|234|3|45|||:0|0_0_0|0|0_0|||:s|0|t|0|t|s_0_V5_E-1.run.res.1M:result = -0.0138863238042842025
#D8_s_s_1|234|345|5|5|6||:0|0_0_0|0_0_0|0|0|0||:s|0|0|t|t|0|s/1|234|345|5|5|6||:0|0_0_0|0_0_0|0|0|0||:s|0|0|t|t|0|s_0_V7_E-2.run.res.1M:result = 0.00203361304696674959
#D8_s_t_t_1|23456|3|45|5|6||:0|0_0_1_0_0|0|0_0|0|0||:s|0|t|0|s|0|t/1|23456|3|45|5|6||:0|0_0_1_0_0|0|0_0|0|0||:s|0|t|0|s|0|t_0_V7_E-2.run.res.1M:result = 3.85783339864735573e-05
#D8_s_t_1|234|345|5|5|6||:0|0_0_0|0_0_0|0|0|0||:s|0|0|t|t|0|s/1|234|345|5|5|6||:0|0_0_0|0_0_0|0|0|0||:s|0|0|t|t|0|s_0_V7_E-2.run.res.1M:result = 1.15723241185716754e-06


res_d8_mk =  {'I1': 0.166666380789930679,  # D8_1|234||||:0|0_0_0||||:s|0|s|t|t
              'J1': -0.0069444234817533949*s + 0*t,  # D8_s_1|234|3|45|||:0|0_0_0|0|0_0|||:s|0|t|0|t|s
              'J2': -0.00694402141261358727*t + 0*s,  # D8_t_1|234|3|45|||:0|0_0_0|0|0_0|||:t|0|s|0|s|t
              'K1': s**2*0.000347226483658657299,   # D8_s_t_1|234|345|5|5|6||:0|0_0_0|0_0_0|0|0|0||:s|0|0|t|t|0|s
              'K2': t**2*0.000347220570106757077,  # D8_s_t_1|234|345|5|5|6||:0|0_0_0|0_0_0|0|0|0||:t|0|0|s|s|0|t
              'K3': s**3*1.92840089983886604e-05+s**2*t*(-1.28627568867977335e-05)+s*t**2*6.42888449618148788e-06+t**3*0,   # D8_s_s_s_1|23456|3|45|5|6||:0|0_0_1_0_0|0|0_0|0|0||:s|0|t|0|s|0|t
              'K4': s**3*0+s**2*t*(6.42954727403550697e-06)+s*t**2*(-1.285821085398203e-05)+t**3*1.92919875736287151e-05,   # D8_t_t_t_1|23456|3|45|5|6||:0|0_0_1_0_0|0|0_0|0|0||:t|0|s|0|t|0|s
              }
for i in sorted(res_d8_kazakov.keys()):
    print i,"\t", (res_d8_kazakov[i].expand()).evalf(),"\tdelta =", ((res_d8_kazakov[i].expand()).evalf()-res_d8_mk[i]).expand(),"\n\t",res_d8_mk[i]


print
print
print "D=6"
print

res_d6_kazakov = {'K3': cln(1)/6,
                 'K4': cln(1)/6,
                 'L1': cln(0),
                 'L2': cln(0),
                 'L3': cln(1)/48,
                 'L4': cln(1)/48,
                 'L5': cln(1)/24,
                 'L6': cln(1)/24,
                 'L7': cln(0),
                 'L8': cln(0),
                 'L9': (t-s)/3/48,
                 'L10': (s-t)/3/48,
                 'L11': cln(0),
                 'L12': cln(0),
                 }


res_d6_mk = {'K3': 0.166672811495946843,
                 'K4': 0.166630234959756984,
                 'L1': cln(0),
                 'L2': cln(0),
                 'L3': 0.02081732,
                 'L4': cln(1)/48,
                 'L5':  0.0416633246884210995,
                 'L6': cln(1)/24,
                 'L7': 0.,
                 'L8': 0.,
                 'L9': -0.001642634*s+0.006941966*t,
                 'L10': (s-t)/3/48,
                 'L11': cln(0),
                 'L12': cln(0),
                 }


for i in sorted(res_d6_kazakov.keys()):
    print i,"\t", (res_d6_kazakov[i].expand()).evalf(),"\tdelta =", ((res_d6_kazakov[i].expand()).evalf()-res_d6_mk[i]).expand(),"\n\t",res_d6_mk[i]
