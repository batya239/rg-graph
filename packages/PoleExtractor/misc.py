__author__ = 'gleb'

from pole_extractor import diagram_calculator, numcalc

var = [('e12|e3|45|46|5|7|88|e8||',
        {-2: (-0.053171283241463, 3.5467140892805985e-05), -4: (-0.00173624, 5.959865770301041e-07),
         -3: (0.004918679999989357, 5.8283445333966395e-06), -1: (0.4475840485005468, 0.00019261933774968805)}),
       ('e12|e3|44|56|7|78|78||e|',
        {-2: (-0.009677680000031968, 1.5778517040581824e-05), -3: (-0.00520908, 1.046135746450021e-06),
         -1: (0.250246488512821, 0.00010847135726979636)}),
       ('e12|e3|45|45|6|7|e8|88||',
        {-2: (0.017521359999978718, 1.9895607555419377e-05), -3: (-0.003472000000000001, 3.181194744117412e-06),
         -1: (-0.10944899079935827, 0.00011427625009379337)}),
       ('e12|e3|e4|55|67|8|78|8||',
        {-2: (-0.11907225702202864, 7.510395724936586e-05), -4: (0.0017366400000000007, 3.394112549696317e-07),
         -3: (0.034427680000010674, 1.0938665366488718e-05), -1: (0.5988127947308651, 0.0004179390443200057)}),
       ('e12|34|35|6|e7|88|e7|8||',
        {-2: (-0.01809924000000001, 6.884533390143922e-06), -1: (0.1697678399998891, 5.464108344457467e-05)}),
       ('e12|34|35|6|e7|e7|88|8||',
        {-2: (-0.020833880000000006, 7.72725048125196e-06), -1: (0.20702951999987232, 6.137692074384546e-05)}),
       ('e12|e3|45|67|e6|88|7|8||',
        {-2: (-0.03605416676674397, 2.4785769816438277e-05), -4: (-0.0017369600000000005, 5.542562584220952e-07),
         -3: (0.004923239999989351, 4.113587242295711e-06), -1: (0.2644885271135005, 0.0001343401181537717)}),
       ('e12|34|56|e5|e6|7|8|88||',
        {-2: (0.04719367999996805, 1.048610509197149e-05), -3: (-0.00520984, 1.495593527667375e-06),
         -1: (-0.33610603298573827, 6.158234806865068e-05)}),
       ('e12|e3|45|46|7|e7|88|8||',
        {-2: (-7.471933062808654e-05, 2.2470285716608792e-05), -4: (-0.00086856, 4.5431266766403845e-07),
         -3: (0.002026879999994675, 3.737164700676832e-06), -1: (-0.0978375895141226, 0.00012062433151518174)}),
       ('e12|34|56|e5|67|8|e|88||',
        {-2: (-0.018100079999999998, 2.876664735419572e-06), -1: (0.18367503999988888, 2.1368088356236427e-05)}),
       ('e12|e3|45|46|7|78|88|e||',
        {-2: (0.017524119999978705, 1.5429426431323132e-05), -3: (-0.0034727200000000003, 2.3085926448813435e-06),
         -1: (-0.0816051143246392, 8.842349723496763e-05)}),
       ('e12|e3|45|67|e6|68||88||',
        {-2: (-8.025148886777085e-05, 2.2526361006297258e-05), -4: (-0.00086832, 4.5431266766403845e-07),
         -3: (0.0020270399999946756, 3.7429400208906574e-06), -1: (-0.09424656749274979, 0.0001221815951828687)}),
       ('e12|e3|45|46|7|e6|8|88||',
        {-2: (0.0016603166166253413, 1.720874603759335e-05), -4: (-0.00086848, 4.5431266766403845e-07),
         -3: (0.0020267599999946755, 3.0323588178157533e-06), -1: (-0.10200130672603672, 8.611519657028339e-05)}),
       ('e12|e3|e4|56|57|6|8|88||',
        {-2: (0.07721421554159125, 2.913544571927968e-05), -4: (0.0008682399999999999, 2.400000000000314e-07),
         -3: (-0.005787639999994674, 2.6006153118053203e-06), -1: (-0.3111895597319966, 0.00018253627737121675)}),
       ('e12|e3|e4|56|56|7|8|88||',
        {-2: (-0.026129121621309665, 2.242317399056611e-05), -4: (0.0005788000000000001, 1.7888543820000193e-07),
         -3: (0.003856520000003548, 3.2172037548153774e-06), -1: (0.2836133405643689, 0.00013363152408419612)}),
       ('e12|e3|e4|56|57|8|78|8||',
        {-2: (0.018415872705696543, 2.3623797265901983e-05), -4: (-0.0017361599999999994, 2.4000000000012566e-07),
         -3: (-0.010415440000010672, 3.8845334340174995e-06), -1: (-0.19215857851480123, 0.00012716167226814682)}),
       ('e12|e3|45|67|e6|78|8|8||',
        {-2: (-0.006145872847702134, 2.6680493438923987e-05), -4: (0.0026039200000000005, 6.462197768562453e-07),
         -3: (-0.007811319999984039, 4.493194854440518e-06), -1: (0.19571207603793386, 0.00013774557359196642)}),
       ('e12|e3|45|46|7|e8|78|8||',
        {-2: (-0.006136729058688346, 2.667764476381802e-05), -4: (0.0026042400000000007, 6.462197768562454e-07),
         -3: (-0.007813159999984038, 4.493194854440517e-06), -1: (0.20634583608692536, 0.00013737619533303412)}),
       ('e12|e3|45|46|7|68|8|e8||',
        {-2: (-0.06719031999993609, 1.20237099100012e-05), -3: (0.01041804, 1.6857046004570827e-06),
         -1: (0.20079810905294754, 7.089297190054243e-05)}),
       ('e12|e3|45|46|7|78|78||e|',
        {-2: (0.02083252, 1.9758542456387517e-06), -1: (-0.15330851999987252, 1.4692202013315653e-05)}),
       ('e12|e3|45|46|7|67|8|8|e|',
        {-2: (0.0180976, 1.6994116629017673e-06), -1: (-0.13003335999988927, 1.239412764175233e-05)}),
       ('e12|34|56|e5|e7|8|78|8||',
        {-2: (-0.15193067999990417, 2.4674197048733746e-05), -3: (0.015621720000000002, 2.909845356716553e-06),
         -1: (0.9833272540999403, 0.00015308523050055713)}),
       ('e12|34|56|e7|58|8|e7|8||',
        {-2: (0.062498880000000014, 7.305888036377106e-06), -1: (-0.796456119999617, 7.032284408360097e-05)}),
       ('e12|34|56|e5|67|8|7|8|e|',
        {-2: (0.054297840000000014, 5.594711788828708e-06), -1: (-0.6748140399996666, 5.326122792430844e-05)}),
       ('e12|34|35|6|67|78|8|e|e|', {-1: (0.08145699999999997, 5.041110988674281e-06)}),
       ('e12|34|35|6|57|8|78|e|e|', {-1: (0.06880375999999995, 4.07136340801145e-06)}),
       ('e12|34|35|6|e7|e8|78|8||',
        {-2: (0.06250044000000003, 6.95620586239928e-06), -1: (-0.7693228799996168, 6.629541160597823e-05)}),
       ('e12|34|35|6|e7|78|e8|8||',
        {-2: (0.0542964, 5.591708146895628e-06), -1: (-0.6539527999996673, 5.2627293299244026e-05)}),
       ('e12|34|35|6|e7|68|7|8|e|', {-1: (0.11046972000000041, 6.966089290286472e-06)}),
       ('e12|34|35|6|e7|67|8|8|e|', {-1: (0.10858992000000015, 6.9227740104842136e-06)}),
       ('e12|34|35|6|e7|78|78||e|', {-1: (0.08145339999999993, 4.411983680855194e-06)}),
       ('e12|e3|45|67|e8|68|7|8||',
        {-2: (0.004265007152297912, 2.661570833444898e-05), -4: (0.0026039200000000005, 6.462197768562454e-07),
         -3: (-0.0078108399999840365, 4.492304531080983e-06), -1: (0.08525565172151806, 0.0001379379518523685)}),
       ('e12|34|35|6|78|78|e7||e|', {-1: (0.06880551999999995, 3.4023521275868353e-06)}),
       ('e12|e3|45|67|56|7|8|8|e|',
        {-2: (-0.059501639999936094, 1.2308241141602517e-05), -3: (0.010417319999999996, 1.725108692228455e-06),
         -1: (0.11703710552771353, 7.27143703713416e-05)}),
       ('e12|34|56|47|8|67|8|e|e|',
        {-2: (-0.3195360799998084, 5.86100332707439e-05), -3: (0.031247840000000002, 7.29734198184651e-06),
         -1: (2.1032759652987245, 0.0003520629593809393)}),
       ('e12|e3|45|67|56|8|7|8|e|',
        {-2: (-0.0018679381173924148, 3.6281519542174575e-05), -4: (0.005208480000000001, 9.138927727039657e-07),
         -3: (-0.018229039999968066, 6.166490087557532e-06), -1: (0.3633490842303696, 0.00018532220617128658)}),
       ('e12|e3|e4|56|78|67|8|8||',
        {-2: (0.03773527096305265, 4.797038241500355e-05), -4: (-0.0034716400000000007, 4.800000000002512e-07),
         -3: (-0.019970200000021327, 7.831015259849662e-06), -1: (-0.2752460064773008, 0.0002582766996785443)}),
       ('e12|34|56|57|68|8|7|e|e|', {-1: (0.04705403999999992, 3.1197435792135673e-06)}),
       ('e12|34|56|e7|58|7|78||e|', {-1: (0.06880484000000002, 5.972202273876413e-06)}),
       ('e12|e3|45|67|67|68||8|e|',
        {-2: (0.018098319999999998, 1.7604544867750908e-06), -1: (-0.13003523999988909, 1.2983189130565478e-05)}),
       ('e12|34|56|e7|56|7|8|8|e|', {-1: (0.08145239999999994, 5.359701484237023e-06)}),
       ('e12|34|56|e7|e8|78|78|||',
        {-2: (0.031250520000000004, 8.995198719317963e-06), -1: (-0.3500099199998084, 7.881534875895692e-05)}),
       ('e12|e3|45|67|e8|67|8|8||',
        {-2: (-0.02330495999996806, 8.239029069004802e-06), -3: (0.0052076399999999995, 1.1838918869561287e-06),
         -1: (0.029475784436414854, 4.884247468503661e-05)}),
       ('e12|e3|e4|56|78|78|78|||',
        {-2: (-0.0182750400000213, 9.569785786524602e-06), -3: (-0.0034723199999999997, 7.838367176907709e-07),
         -1: (0.005563105411408684, 5.969163400999163e-05)})]


for l, e in var:
    d1 = numcalc.NumEpsExpansion(e)
    d2 = diagram_calculator.get_expansion(l, rprime=False, momentum_derivative=False)
    print '\n###\n' + str(d1) + '\n' + str(d2) + '\n' + str(d1 == d2) + '\n###'
    #if d1 == d2:
    #    diagram_calculator.update_expansion(l, rprime=False, momentum_derivative=False, e=d1, force_update=False)